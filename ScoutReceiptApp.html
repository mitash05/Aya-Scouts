<!DOCTYPE html>
<html lang="hy">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AYA Scout Receipt Generator</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;700&family=Noto+Sans+Armenian:wght@400;500;700&display=swap" rel="stylesheet">
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <style>
        /* GLOBAL STYLES */
        :root {
          --primary: #4f46e5;
          --text-main: #1e293b;
          --glass-surface: rgba(255, 255, 255, 0.65);
        }
        body {
          font-family: 'Outfit', 'Noto Sans Armenian', sans-serif;
          margin: 0;
          color: var(--text-main);
          background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
          min-height: 100vh;
        }
        
        /* BACKGROUND ANIMATION */
        .ambient-light { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; pointer-events: none; overflow: hidden; }
        .orb { position: absolute; border-radius: 50%; filter: blur(80px); opacity: 0.6; animation: float 20s infinite ease-in-out; }
        .orb-1 { top: -10%; left: -10%; width: 50vw; height: 50vw; background: radial-gradient(circle, #818cf8 0%, rgba(129,140,248,0) 70%); }
        .orb-2 { bottom: -10%; right: -10%; width: 60vw; height: 60vw; background: radial-gradient(circle, #f472b6 0%, rgba(244,114,182,0) 70%); animation-delay: -5s; }
        @keyframes float { 0%, 100% { transform: translate(0, 0); } 50% { transform: translate(30px, -30px); } }

        /* GLASS CARD */
        .glass-card {
          background: var(--glass-surface);
          backdrop-filter: blur(25px);
          -webkit-backdrop-filter: blur(25px);
          border: 1px solid rgba(255, 255, 255, 0.8);
          box-shadow: 0 20px 50px -10px rgba(0,0,0,0.1);
          border-radius: 32px;
          padding: 30px;
          margin-bottom: 80px;
        }

        /* INPUTS */
        input, select {
          width: 100%; 
          padding: 16px 12px 16px 24px !important;
          font-size: 18px;
          border: 1px solid rgba(136, 136, 136, 0.2);
          border-radius: 20px; 
          background: rgba(255, 255, 255, 0.6); 
          color: var(--text-main);
          outline: none;
          -webkit-appearance: none;
        }
        input:focus, select:focus {
          background: white; 
          box-shadow: 0 0 0 4px rgba(79, 70, 229, 0.1);
        }

        /* CUSTOM SELECT ARROW */
        select {
          background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
          background-position: right 1rem center;
          background-repeat: no-repeat;
          background-size: 1.5em 1.5em;
        }

        label {
          display: block; font-size: 14px; font-weight: 700; margin-bottom: 10px;
          color: #64748b; margin-left: 20px; text-transform: uppercase; letter-spacing: 0.8px;
        }

        /* BUTTONS */
        .btn-primary {
          background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
          color: white; border: none; width: 100%; padding: 22px;
          font-size: 17px; font-weight: 700; border-radius: 24px;
          cursor: pointer; box-shadow: 0 10px 30px -5px rgba(79, 70, 229, 0.4);
          display: flex; align-items: center; justify-content: center; gap: 10px;
        }
        .btn-secondary {
          background: white; color: var(--text-main); border: 1px solid rgba(0,0,0,0.1);
          padding: 18px; border-radius: 18px; font-weight: 600; cursor: pointer;
          display: flex; align-items: center; justify-content: center; gap: 8px; width: 100%;
        }

        /* RECEIPT VISUALS */
        .receipt-paper {
          background: white; padding: 30px; border-radius: 4px;
          box-shadow: 0 10px 30px rgba(0,0,0,0.1); border-top: 8px solid #1e293b;
          position: relative; overflow: hidden;
        }
        .watermark {
          position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) rotate(-45deg);
          font-size: 80px; font-weight: 900; color: rgba(0,0,0,0.03);
          pointer-events: none; border: 4px solid rgba(0,0,0,0.03); border-radius: 50%; padding: 20px;
        }
        .receipt-row { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px dashed #f1f5f9; padding-bottom: 10px; }
        .receipt-row:last-child { border-bottom: none; }

        /* CHIPS */
        .chip {
          padding: 10px 14px; border-radius: 12px; font-size: 14px; font-weight: 600;
          border: 1px solid rgba(79, 70, 229, 0.2); background: rgba(79, 70, 229, 0.05);
          color: var(--primary); cursor: pointer;
        }
        .chip.active { background: var(--primary); color: white; }

        /* NAV */
        nav {
          position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
          background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(20px);
          border-radius: 100px; padding: 10px 20px;
          box-shadow: 0 10px 40px rgba(0,0,0,0.1);
          border: 1px solid rgba(255,255,255,0.5);
          display: flex; gap: 10px; z-index: 100;
        }
        .nav-item {
          width: 50px; height: 50px; border-radius: 50%;
          display: flex; align-items: center; justify-content: center;
          color: #94a3b8; transition: 0.3s; cursor: pointer;
        }
        .nav-item.active { background: #1e293b; color: white; transform: translateY(-5px); }

        /* PRINT / PDF STYLES - FIXED FOR CENTERING AND FILLING PAGE */
        @media print {
          @page { margin: 0; size: auto; }
          body * { visibility: hidden; }
          #receipt-container, #receipt-container * { visibility: visible; }
          #receipt-container { 
            position: absolute; 
            left: 50%; 
            top: 50%; 
            /* Scale up 1.6x to fill the page comfortably */
            transform: translate(-50%, -50%) scale(1.6);
            width: 450px; /* Base width */
            margin: 0;
            box-shadow: none;
            border: 1px solid #eee;
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
          }
          button { display: none !important; }
        }
    </style>
</head>
<body>
    
<div id="root"></div>

<script type="text/babel">
    const { useState, useEffect } = React;

    // --- ICONS ---
    const Icons = {
        FileText: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/></svg>,
        History: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>,
        Save: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></svg>,
        Image: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/></svg>,
        FilePdf: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><path d="M16 13H8"/><path d="M16 17H8"/><path d="M10 9H8"/></svg>,
        Shield: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>,
        GoogleDrive: (props) => (
            <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 87.3 78" fill="currentColor">
                <path d="M6.6 66.85l3.85 6.65c.8 1.4 1.95 2.5 3.3 3.3l13.75-23.8h-27.5c0 1.55.4 3.1 1.2 4.5z" fill="#0066DA"/>
                <path d="M43.65 25l13.75-23.8c-1.35-.8-2.9-1.2-4.5-1.2h-18.5c-1.6 0-3.15.45-4.5 1.2l13.75 23.8z" fill="#00AC47"/>
                <path d="M73.55 76.8c1.35-.8 2.5-1.9 3.3-3.3l1.6-2.75 7.65-13.25c.8-1.4 1.2-2.95 1.2-4.5h-27.5l13.75 23.8z" fill="#EA4335"/>
                <path d="M43.65 25L27.5 53.05l-13.75 23.8 26.1 45.1h27.5L43.65 25z" fill="#00AC47" opacity="0"/>
                <path d="M73.55 76.8L59.8 53.05 43.65 25 27.5 53.05h27.5l1.8 3.1 13.75 23.8z" fill="#2684FC" opacity="0"/>
                <path d="M20.9 25L7.15 48.8c-.8 1.4-1.2 2.95-1.2 4.5l13.75-23.8L33.45 2.15c-1.35.8-2.5 1.9-3.3 3.3L20.9 25z" fill="#FFBA00"/>
            </svg>
        )
    };

    // --- CONFIG ---
    const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbw_oA7qTCe2fnV-hbn_-7Vl1o8_yP-x2f8laFPauvo87A4XssiGq5tBbvvYTmEGrSlv/exec'; 
    const DRIVE_FOLDER_ID = '1UZTzEd9AvjZArsn678BrrkgfELuyqvuK';

    const App = () => {
        const [activeTab, setActiveTab] = useState('new');
        const [loading, setLoading] = useState(false);
        const [history, setHistory] = useState([]);
        const [generatedReceipt, setGeneratedReceipt] = useState(null);

        // Constants
        const MONTHS = ['’Ä’∏÷Ç’∂', '’ì’•’ø', '’Ñ’°÷Ä’ø', '‘±’∫÷Ä', '’Ñ’°’µ', '’Ä’∏÷Ç’∂’´’Ω', '’Ä’∏÷Ç’¨', '’ï’£’∏’Ω', '’ç’•’∫', '’Ä’∏’Ø', '’Ü’∏’µ', '‘¥’•’Ø'];
        const UNIFORM_ITEMS = ['‘≥’¨’≠’°÷Ä’Ø', '’ì’∏’≤’Ø’°’∫', '’ï’≤’°’Ø', '’á’°’∫’´’Ø', '’ç’æ’´’ø’•÷Ä', '‘π’´-’á’°’∫’´’Ø'];
        const ITEMS_WITH_SIZE = ['’á’°’∫’´’Ø', '’ç’æ’´’ø’•÷Ä', '‘π’´-’á’°’∫’´’Ø'];
        const SIZES = ['XS', 'S', 'M', 'L', 'XL', 'XXL'];

        const [formData, setFormData] = useState({
            prefix: 'SA', // Default Prefix
            scoutName: '',
            amount: '',
            paymentDate: new Date().toISOString().split('T')[0],
            type: '‘±’∂’§’°’¥’°’æ’≥’°÷Ä',
            paidBy: '‘æ’∂’∏’≤',
            leaderName: '',
            membershipMonths: [],
            uniformItem: '’á’°’∫’´’Ø',
            uniformSize: 'M'
        });

        useEffect(() => {
            const savedHistory = localStorage.getItem('scout_payment_history');
            if (savedHistory) setHistory(JSON.parse(savedHistory));
        }, []);

        // --- ID GENERATION LOGIC ---
        const generateTxId = (prefix) => {
            let currentSeq = parseInt(localStorage.getItem('scout_receipt_sequence') || '0');
            let nextSeq = currentSeq + 1;
            localStorage.setItem('scout_receipt_sequence', nextSeq.toString());
            const seqStr = nextSeq.toString().padStart(4, '0');
            return `AYA-${prefix}-${seqStr}`;
        };

        const handleInputChange = (e) => {
            const { name, value } = e.target;
            setFormData(prev => ({ ...prev, [name]: value }));
        };

        const toggleMonth = (month) => {
            setFormData(prev => {
                const currentMonths = prev.membershipMonths || [];
                const newMonths = currentMonths.includes(month)
                    ? currentMonths.filter(m => m !== month)
                    : [...currentMonths, month];
                return { ...prev, membershipMonths: newMonths };
            });
        };

        const syncToCloud = async (receiptData) => {
            if (!GOOGLE_SCRIPT_URL) return 'Local Only';
            try {
                let detailedType = receiptData.type;
                if (receiptData.type === '‘±’∂’§’°’¥’°’æ’≥’°÷Ä' && receiptData.membershipMonths?.length > 0) {
                    detailedType += ` (${receiptData.membershipMonths.join(', ')})`;
                } else if (receiptData.type === '’è’°÷Ä’°’¶') {
                    detailedType += ` - ${receiptData.uniformItem}`;
                    if (ITEMS_WITH_SIZE.includes(receiptData.uniformItem)) {
                        detailedType += ` (${receiptData.uniformSize})`;
                    }
                }

                const payload = {
                    ...receiptData,
                    detailedType: detailedType,
                    folderId: DRIVE_FOLDER_ID 
                };

                await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors', 
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                return 'Saved to Cloud';
            } catch (error) {
                console.error("Cloud Error", error);
                return 'Cloud Error';
            }
        };

        const handleSubmit = async (e) => {
            e.preventDefault();
            setLoading(true);

            const newReceipt = {
                ...formData,
                id: generateTxId(formData.prefix), // Pass selected prefix
                timestamp: new Date().toISOString() 
            };

            const updatedHistory = [newReceipt, ...history];
            setHistory(updatedHistory);
            localStorage.setItem('scout_payment_history', JSON.stringify(updatedHistory));

            const syncStatus = await syncToCloud(newReceipt);
            setGeneratedReceipt({ ...newReceipt, status: syncStatus });
            setLoading(false);
            setActiveTab('receipt');
        };

        const handleManualSaveToDrive = async () => {
            if(!generatedReceipt) return;
            setLoading(true);
            const status = await syncToCloud(generatedReceipt);
            setGeneratedReceipt(prev => ({ ...prev, status: status }));
            setLoading(false);
            alert("Sent to Google Drive!");
        };

        // --- SAVE IMAGE FUNCTION ---
        const handleSaveImage = () => {
            const receiptElement = document.getElementById('receipt-container');
            if(!receiptElement) return;

            html2canvas(receiptElement, {
                scale: 3, // High resolution
                backgroundColor: null, // Transparent border
                useCORS: true 
            }).then(canvas => {
                const link = document.createElement('a');
                link.download = `Receipt_${generatedReceipt.id}.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();
            });
        };

        // --- PRINT PDF FUNCTION ---
        const handlePrintPDF = () => {
            window.print();
        };

        const getDetailsString = (data) => {
            if (data.type === '‘±’∂’§’°’¥’°’æ’≥’°÷Ä') {
                return data.membershipMonths && data.membershipMonths.length > 0 
                    ? `‘±’¥’´’Ω’∂’•÷Ä: ${data.membershipMonths.join(', ')}` 
                    : '';
            }
            if (data.type === '’è’°÷Ä’°’¶') {
                let str = data.uniformItem;
                if (ITEMS_WITH_SIZE.includes(data.uniformItem)) {
                    str += ` (’â’°÷É’Ω: ${data.uniformSize})`;
                }
                return str;
            }
            return '';
        };

        const resetForm = () => {
            setFormData({
                prefix: formData.prefix, // Keep last selection
                scoutName: '',
                amount: '',
                paymentDate: new Date().toISOString().split('T')[0],
                type: '‘±’∂’§’°’¥’°’æ’≥’°÷Ä',
                paidBy: '‘æ’∂’∏’≤',
                leaderName: formData.leaderName,
                membershipMonths: [],
                uniformItem: '’á’°’∫’´’Ø',
                uniformSize: 'M'
            });
            setGeneratedReceipt(null);
            setActiveTab('new');
        };

        const ReceiptCard = ({ data }) => {
            const extraDetails = getDetailsString(data);
            return (
                <div id="receipt-container" className="receipt-paper">
                    <div className="watermark">PAID</div>
                    <div className="flex flex-col items-center mb-4">
                        <img 
                            src="AYA.png" 
                            alt="AYA Logo" 
                            className="h-20 object-contain mb-2"
                            onError={(e) => { e.target.style.display = 'none'; e.target.nextSibling.style.display = 'block'; }}
                        />
                        <div className="hidden"><Icons.Shield className="w-16 h-16 text-blue-900" /></div>
                        <h2 className="text-xl font-bold text-gray-900 tracking-tight mt-2 uppercase">’é’≥’°÷Ä’¥’°’∂ ‘±’∂’§’∏÷Ä÷Ä’°’£’´÷Ä</h2>
                        <p className="text-xs text-gray-500 font-mono">{data.id}</p>
                    </div>

                    <div className="space-y-4 text-base">
                        <div className="receipt-row">
                            <span className="text-gray-500">‘±’¥’Ω’°’©’´’æ</span>
                            <span className="font-semibold">{data.paymentDate}</span>
                        </div>
                        <div className="receipt-row">
                            <span className="text-gray-500">’ç’Ø’°’∏÷Ç’ø</span>
                            <span className="font-bold text-gray-800">{data.scoutName}</span>
                        </div>
                        <div className="receipt-row">
                            <span className="text-gray-500">’Ü’∫’°’ø’°’Ø</span>
                            <span className="text-gray-800 text-right">{data.type}</span>
                        </div>
                        
                        {extraDetails && (
                            <div className="bg-gray-50 p-2 rounded text-sm text-center border border-gray-100">
                                <span className="text-gray-800 font-medium">{extraDetails}</span>
                            </div>
                        )}

                        <div className="receipt-row pt-2 border-t border-dashed border-gray-300">
                            <span className="text-gray-500">‘≥’∏÷Ç’¥’°÷Ä</span>
                            <span className="text-3xl font-bold text-blue-900">÷è{data.amount}</span>
                        </div>
                    </div>

                    <div className="mt-8 pt-4 border-t border-gray-100 flex justify-between items-end">
                        <div className="text-left">
                            <p className="text-[12px] text-gray-400 uppercase tracking-widest">’é’≥’°÷Ä’∏’≤</p>
                            <p className="font-medium text-gray-700 text-base">{data.paidBy}</p>
                        </div>
                        <div className="text-right">
                            <p className="text-[12px] text-gray-400 uppercase tracking-widest">’ç’ø’°÷Å’∏’≤ (’Ç’•’Ø’°’æ’°÷Ä)</p>
                            <p className="font-medium text-gray-700 text-base">{data.leaderName}</p>
                        </div>
                    </div>
                </div>
            );
        };

        return (
            <div>
                {/* Home Button */}
                <a href="index.html" style={{position: 'absolute', top: '20px', left: '20px', zIndex: 100, textDecoration: 'none', fontSize: '24px', background: 'rgba(255,255,255,0.2)', width: '40px', height: '40px', borderRadius: '50%', display: 'flex', alignItems: 'center', justifyContent: 'center', backdropFilter: 'blur(5px)', boxShadow: '0 4px 6px rgba(0,0,0,0.1)'}}>
                    üè†
                </a>

                <div className="ambient-light">
                    <div className="orb orb-1"></div>
                    <div className="orb orb-2"></div>
                </div>

                <div className="max-w-md mx-auto p-6 pt-20">
                    <div className="text-center mb-8 relative z-10">
                        <img src="AYA logo vahanig.png" alt="Logo" className="w-24 mx-auto mb-2 drop-shadow-xl" style={{animation:'levitate 6s ease-in-out infinite'}} />
                        <h1 className="text-2xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-slate-800 to-slate-500">‘±’∂’§’∏÷Ä÷Ä’°’£÷Ä’´ ’ç’ø’•’≤’Æ’∏÷Ç’¥</h1>
                    </div>

                    <div className="glass-card">
                        {activeTab === 'new' && (
                            <form onSubmit={handleSubmit} className="space-y-6">
                                {/* PREFIX SELECTOR */}
                                <div>
                                    <label>‘∏’∂’ø÷Ä’•’¨ ID ‘Ω’∏÷Ç’¥’¢</label>
                                    <div className="flex gap-2">
                                        {['SA', 'KA', 'YK'].map(p => (
                                            <button 
                                                type="button" 
                                                key={p} 
                                                onClick={() => setFormData({...formData, prefix: p})} 
                                                className={`flex-1 p-3 rounded-xl border font-bold transition ${formData.prefix === p ? 'bg-indigo-600 text-white border-indigo-600' : 'bg-white text-gray-500'}`}
                                            >
                                                {p}
                                            </button>
                                        ))}
                                    </div>
                                    <p className="text-xs text-right mt-1 text-slate-400">ID ’Ø’¨’´’∂’´: AYA-{formData.prefix}-XXXX</p>
                                </div>

                                <div className="grid grid-cols-2 gap-4">
                                    <div>
                                        <label>‘±’¥’Ω’°’©’´’æ</label>
                                        <input type="date" name="paymentDate" required value={formData.paymentDate} onChange={handleInputChange} />
                                    </div>
                                    <div>
                                        <label>‘≥’∏÷Ç’¥’°÷Ä (÷è)</label>
                                        <input type="number" name="amount" required placeholder="5000" className="font-bold text-lg" value={formData.amount} onChange={handleInputChange} />
                                    </div>
                                </div>
                                <div>
                                    <label>’ç’Ø’°’∏÷Ç’ø’´ ‘±’∂’∏÷Ç’∂</label>
                                    <input type="text" name="scoutName" required placeholder="‘±÷Ä’°’¥ ‘±÷Ä’°’¥’µ’°’∂" value={formData.scoutName} onChange={handleInputChange} />
                                </div>
                                <div>
                                    <label>’é’≥’°÷Ä’¥’°’∂ ’Ü’∫’°’ø’°’Ø</label>
                                    <select name="type" value={formData.type} onChange={(e) => {
                                        handleInputChange(e);
                                        setFormData(prev => ({...prev, type: e.target.value, membershipMonths: [], uniformItem: '’á’°’∫’´’Ø'}));
                                    }}>
                                        <option>‘±’∂’§’°’¥’°’æ’≥’°÷Ä</option>
                                        <option>’è’°÷Ä’°’¶</option>
                                        <option>‘≤’°’∂’°’Ø’¥’°’∂ ‘ø’°’∂’≠’°’æ’≥’°÷Ä</option>
                                        <option>’Ä’°’∂’£’°’∂’°’Ø’∏÷Ç’©’µ’∏÷Ç’∂</option>
                                        <option>‘±’µ’¨</option>
                                    </select>
                                </div>

                                {formData.type === '‘±’∂’§’°’¥’°’æ’≥’°÷Ä' && (
                                    <div className="bg-indigo-50/50 p-4 rounded-2xl border border-indigo-100">
                                        <label className="!text-indigo-900 !ml-0 mb-3">‘∏’∂’ø÷Ä’•’¨ ‘±’¥’´’Ω’∂’•÷Ä</label>
                                        <div className="grid grid-cols-4 gap-2">
                                            {MONTHS.map(m => (
                                                <button key={m} type="button" onClick={() => toggleMonth(m)} className={`chip ${formData.membershipMonths.includes(m) ? 'active' : ''}`}>{m}</button>
                                            ))}
                                        </div>
                                    </div>
                                )}

                                {formData.type === '’è’°÷Ä’°’¶' && (
                                    <div className="bg-indigo-50/50 p-4 rounded-2xl border border-indigo-100 grid grid-cols-2 gap-3">
                                        <div>
                                            <label className="!text-indigo-900 !ml-0">’è’•’Ω’°’Ø</label>
                                            <select name="uniformItem" value={formData.uniformItem} onChange={handleInputChange}>
                                                {UNIFORM_ITEMS.map(item => <option key={item} value={item}>{item}</option>)}
                                            </select>
                                        </div>
                                        {ITEMS_WITH_SIZE.includes(formData.uniformItem) && (
                                            <div>
                                                <label className="!text-indigo-900 !ml-0">’â’°÷É’Ω</label>
                                                <select name="uniformSize" value={formData.uniformSize} onChange={handleInputChange}>
                                                    {SIZES.map(s => <option key={s} value={s}>{s}</option>)}
                                                </select>
                                            </div>
                                        )}
                                    </div>
                                )}

                                <div>
                                    <label>’é’≥’°÷Ä’∏’≤</label>
                                    <div className="flex gap-3">
                                        <button type="button" onClick={() => setFormData({...formData, paidBy: '‘æ’∂’∏’≤'})} className={`flex-1 p-3 rounded-xl border font-semibold text-sm transition ${formData.paidBy === '‘æ’∂’∏’≤' ? 'bg-slate-800 text-white border-slate-800' : 'bg-white text-slate-500 hover:bg-slate-50'}`}>‘æ’∂’∏’≤</button>
                                        <button type="button" onClick={() => setFormData({...formData, paidBy: '’ç’Ø’°’∏÷Ç’ø'})} className={`flex-1 p-3 rounded-xl border font-semibold text-sm transition ${formData.paidBy === '’ç’Ø’°’∏÷Ç’ø' ? 'bg-slate-800 text-white border-slate-800' : 'bg-white text-slate-500 hover:bg-slate-50'}`}>’ç’Ø’°’∏÷Ç’ø</button>
                                    </div>
                                </div>

                                <div>
                                    <label>’ç’ø’°÷Å’∏’≤ (’Ç’•’Ø’°’æ’°÷Ä)</label>
                                    <input type="text" name="leaderName" required placeholder="’Ç’•’Ø’°’æ’°÷Ä’´ ‘±’∂’∏÷Ç’∂" value={formData.leaderName} onChange={handleInputChange} />
                                </div>

                                <button type="submit" disabled={loading} className="btn-primary">
                                    {loading ? '’ç’ø’•’≤’Æ’æ’∏÷Ç’¥ ’ß...' : <><Icons.Save className="w-5 h-5" /> ’ç’ø’•’≤’Æ’•’¨ ‘±’∂’§’∏÷Ä÷Ä’°’£’´÷Ä</>}
                                </button>
                            </form>
                        )}

                        {activeTab === 'receipt' && generatedReceipt && (
                            <div>
                                <ReceiptCard data={generatedReceipt} />
                                
                                <div className="space-y-3 mt-6">
                                    {/* BUTTON 1: SAVE IMAGE */}
                                    <button onClick={handleSaveImage} className="btn-secondary text-indigo-600 border-indigo-100 hover:bg-indigo-50">
                                        <Icons.Image className="w-5 h-5"/> Save Image
                                    </button>
                                    
                                    {/* BUTTON 2: SEND AS PDF */}
                                    <button onClick={handlePrintPDF} className="btn-secondary">
                                        <Icons.FilePdf className="w-5 h-5"/> Send as PDF
                                    </button>
                                    
                                    {/* BUTTON 3: DRIVE */}
                                    <button onClick={handleManualSaveToDrive} className="btn-secondary !text-green-600 !border-green-100">
                                        <Icons.GoogleDrive className="w-5 h-5"/> Drive-’∏÷Ç’¥
                                    </button>
                                </div>
                                <button onClick={resetForm} className="w-full mt-6 py-3 text-sm font-semibold text-slate-400 hover:text-slate-600 transition">+ ’Ü’∏÷Ä ’é’≥’°÷Ä’∏÷Ç’¥</button>
                            </div>
                        )}

                        {activeTab === 'history' && (
                            <div>
                                <h2 className="text-xl font-bold mb-4">’ä’°’ø’¥’∏÷Ç’©’µ’∏÷Ç’∂</h2>
                                {history.length === 0 ? (
                                    <div className="text-center py-10 text-slate-400 border-2 border-dashed border-slate-200 rounded-2xl">‘¥’•’º ’°’∂’§’∏÷Ä÷Ä’°’£÷Ä’•÷Ä ’π’Ø’°’∂</div>
                                ) : (
                                    <div className="space-y-3">
                                        {history.map((item) => (
                                            <div key={item.id} onClick={() => { setGeneratedReceipt(item); setActiveTab('receipt'); }}
                                                className="bg-white p-4 rounded-xl border border-slate-100 shadow-sm flex justify-between items-center cursor-pointer hover:shadow-md transition"
                                            >
                                                <div>
                                                    <p className="font-bold text-slate-800">{item.scoutName}</p>
                                                    <p className="text-xs text-slate-500">{item.paymentDate} ‚Ä¢ {item.type}</p>
                                                </div>
                                                <div className="text-right">
                                                    <p className="font-bold text-indigo-600">÷è{item.amount}</p>
                                                    <p className="text-[10px] text-slate-400">{item.id}</p>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                )}
                            </div>
                        )}
                    </div>
                </div>

                <nav>
                    <div className={`nav-item ${activeTab === 'new' ? 'active' : ''}`} onClick={() => setActiveTab('new')}><Icons.FileText className="w-6 h-6" /></div>
                    <div className={`nav-item ${activeTab === 'history' ? 'active' : ''}`} onClick={() => setActiveTab('history')}><Icons.History className="w-6 h-6" /></div>
                </nav>
            </div>
        );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
</script>

</body>
</html>
