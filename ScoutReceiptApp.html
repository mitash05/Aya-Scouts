<!DOCTYPE html>
<html lang="hy">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AYA Scout Receipt Generator</title>
    
    <!-- FONTS -->
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;700&family=Noto+Sans+Armenian:wght@400;500;700&display=swap" rel="stylesheet">
    
    <!-- TAILWIND CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- REACT & BABEL (To run the app directly in browser) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        /* GLOBAL STYLES & GLASSMORPHISM */
        :root {
          --primary: #4f46e5;
          --primary-glow: rgba(79, 70, 229, 0.4);
          --text-main: #1e293b;
          --text-light: #64748b;
          --glass-surface: rgba(255, 255, 255, 0.65);
          --glass-border: rgba(255, 255, 255, 0.8);
          --input-bg: rgba(255, 255, 255, 0.6);
        }
        body {
          font-family: 'Outfit', 'Noto Sans Armenian', sans-serif;
          margin: 0;
          color: var(--text-main);
          background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
          min-height: 100vh;
        }
        
        /* AMBIENT BACKGROUND */
        .ambient-light { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; pointer-events: none; overflow: hidden; }
        .orb { position: absolute; border-radius: 50%; filter: blur(80px); opacity: 0.6; animation: float 20s infinite ease-in-out; }
        .orb-1 { top: -10%; left: -10%; width: 50vw; height: 50vw; background: radial-gradient(circle, #818cf8 0%, rgba(129,140,248,0) 70%); }
        .orb-2 { bottom: -10%; right: -10%; width: 60vw; height: 60vw; background: radial-gradient(circle, #f472b6 0%, rgba(244,114,182,0) 70%); animation-delay: -5s; }
        @keyframes float { 0%, 100% { transform: translate(0, 0); } 50% { transform: translate(30px, -30px); } }

        /* GLASS CARD */
        .glass-card {
          background: var(--glass-surface);
          backdrop-filter: blur(25px);
          -webkit-backdrop-filter: blur(25px);
          border: 1px solid var(--glass-border);
          box-shadow: 0 20px 50px -10px rgba(0,0,0,0.1), 0 0 0 1px rgba(255,255,255,0.5) inset;
          border-radius: 32px;
          padding: 30px;
          margin-bottom: 80px;
        }

        /* INPUTS - REFINED PADDING */
        input, select {
          width: 100%; 
          /* Top/Bottom: 16px
             Left: 24px (Enough to clear curve, not too much to push text off screen)
             Right: 12px (Keep small to allow date picker icon space)
          */
          padding: 16px 12px 16px 24px !important;
          
          font-size: 18px;
          border: 1px solid rgba(136, 136, 136, 0.2);
          border-radius: 20px; 
          background: var(--input-bg); 
          color: var(--text-main);
          font-family: inherit; 
          transition: 0.3s; 
          outline: none;
          box-sizing: border-box;
          
          /* Remove default browser styling */
          -webkit-appearance: none;
          -moz-appearance: none;
          appearance: none;
        }
        
        /* Specific fix for Date Inputs to align calendar icon */
        input[type="date"] {
            /* Ensure the text has room but icon stays visible */
            display: block;
        }
        
        input:focus, select:focus {
          background: white; 
          box-shadow: 0 0 0 4px rgba(79, 70, 229, 0.1);
          border-color: rgba(79, 70, 229, 0.3); 
          transform: translateY(-1px);
        }

        /* Custom arrow for Select */
        select {
          background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
          background-position: right 1rem center;
          background-repeat: no-repeat;
          background-size: 1.5em 1.5em;
          padding-right: 2.5rem !important;
        }

        label {
          display: block; 
          font-size: 14px;
          font-weight: 700; 
          margin-bottom: 10px;
          color: var(--text-light); 
          margin-left: 20px;
          text-transform: uppercase; 
          letter-spacing: 0.8px;
        }

        /* BUTTONS */
        .btn-primary {
          background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
          color: white; border: none; width: 100%; padding: 22px;
          font-size: 17px; font-weight: 700; border-radius: 24px;
          cursor: pointer; box-shadow: 0 10px 30px -5px var(--primary-glow);
          transition: 0.3s; display: flex; align-items: center; justify-content: center; gap: 10px;
        }
        .btn-primary:active { transform: scale(0.98); }
        .btn-secondary {
          background: white; color: var(--text-main); border: 1px solid rgba(0,0,0,0.1);
          padding: 18px; border-radius: 18px; font-weight: 600; cursor: pointer;
          display: flex; align-items: center; justify-content: center; gap: 8px; transition: 0.2s;
        }
        .btn-secondary:hover { background: #f8fafc; transform: translateY(-2px); }

        /* RECEIPT VISUALS */
        .receipt-paper {
          background: white; padding: 30px; border-radius: 4px;
          box-shadow: 0 10px 30px rgba(0,0,0,0.1); border-top: 8px solid #1e293b;
          position: relative; overflow: hidden;
        }
        .watermark {
          position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) rotate(-45deg);
          font-size: 80px; font-weight: 900; color: rgba(0,0,0,0.03);
          pointer-events: none; border: 4px solid rgba(0,0,0,0.03); border-radius: 50%; padding: 20px;
        }
        .receipt-row { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px dashed #f1f5f9; padding-bottom: 10px; }
        .receipt-row:last-child { border-bottom: none; }

        /* CHIPS */
        .chip {
          padding: 10px 14px; border-radius: 12px; font-size: 14px; font-weight: 600;
          border: 1px solid rgba(79, 70, 229, 0.2); background: rgba(79, 70, 229, 0.05);
          color: var(--primary); cursor: pointer; transition: 0.2s;
        }
        .chip.active { background: var(--primary); color: white; }

        /* NAV */
        nav {
          position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
          background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(20px);
          border-radius: 100px; padding: 10px 20px;
          box-shadow: 0 10px 40px rgba(0,0,0,0.1);
          border: 1px solid rgba(255,255,255,0.5);
          display: flex; gap: 10px; z-index: 100;
        }
        .nav-item {
          width: 50px; height: 50px; border-radius: 50%;
          display: flex; align-items: center; justify-content: center;
          color: #94a3b8; transition: 0.3s; cursor: pointer;
        }
        .nav-item.active { background: #1e293b; color: white; transform: translateY(-5px); box-shadow: 0 5px 15px rgba(0,0,0,0.2); }

        /* PRINT STYLES */
        @media print {
          body * { visibility: hidden; }
          .receipt-paper, .receipt-paper * { visibility: visible; }
          .receipt-paper { position: absolute; left: 0; top: 0; width: 100%; box-shadow: none; border: 1px solid #ddd; }
        }
        
        /* ANIMATIONS */
        @keyframes levitate { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
    </style>
</head>
<body>

<div id="root"></div>

<script type="text/babel">
    const { useState, useEffect } = React;

    // --- ICONS (Simple SVGs) ---
    const Icons = {
        FileText: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/></svg>,
        // CHANGED TO CLOCK ICON FOR BETTER VISIBILITY
        History: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>,
        Save: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></svg>,
        Printer: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/><rect x="6" y="14" width="12" height="8"/></svg>,
        Share2: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="18" cy="5" r="3"/><circle cx="6" cy="12" r="3"/><circle cx="18" cy="19" r="3"/><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/></svg>,
        Copy: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>,
        Cloud: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M17.5 19c0-3.037-2.463-5.5-5.5-5.5S6.5 15.963 6.5 19"/><path d="M20 16.5c1.4-.5 2.6-1.5 2.6-3.5 0-2.8-2.2-5-5-5-2 0-3.6 1.1-4.5 2.5C12.1 9.4 10.2 8 8 8c-3.3 0-6 2.7-6 6 0 1.2.4 2.3 1 3.2"/></svg>,
        Shield: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
    };

    // --- CONFIGURATION ---
    const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbw_oA7qTCe2fnV-hbn_-7Vl1o8_yP-x2f8laFPauvo87A4XssiGq5tBbvvYTmEGrSlv/exec'; // Paste your script URL here
    const DRIVE_FOLDER_ID = '1UZTzEd9AvjZArsn678BrrkgfELuyqvuK';
    const LEADER_ID = 'A'; 

    const App = () => {
        const [activeTab, setActiveTab] = useState('new');
        const [loading, setLoading] = useState(false);
        const [history, setHistory] = useState([]);
        const [generatedReceipt, setGeneratedReceipt] = useState(null);

        // Armenian Constants
        const MONTHS = ['’Ä’∏÷Ç’∂', '’ì’•’ø', '’Ñ’°÷Ä’ø', '‘±’∫÷Ä', '’Ñ’°’µ', '’Ä’∏÷Ç’∂’´’Ω', '’Ä’∏÷Ç’¨', '’ï’£’∏’Ω', '’ç’•’∫', '’Ä’∏’Ø', '’Ü’∏’µ', '‘¥’•’Ø'];
        const UNIFORM_ITEMS = ['‘≥’¨’≠’°÷Ä’Ø', '’ì’∏’≤’Ø’°’∫', '’ï’≤’°’Ø', '’á’°’∫’´’Ø', '’ç’æ’´’ø’•÷Ä', '‘π’´-’á’°’∫’´’Ø'];
        const ITEMS_WITH_SIZE = ['’á’°’∫’´’Ø', '’ç’æ’´’ø’•÷Ä', '‘π’´-’á’°’∫’´’Ø'];
        const SIZES = ['XS', 'S', 'M', 'L', 'XL', 'XXL'];

        const [formData, setFormData] = useState({
            scoutName: '',
            amount: '',
            paymentDate: new Date().toISOString().split('T')[0],
            type: '‘±’∂’§’°’¥’°’æ’≥’°÷Ä',
            paidBy: '‘æ’∂’∏’≤',
            leaderName: '',
            notes: '',
            membershipMonths: [],
            uniformItem: '’á’°’∫’´’Ø',
            uniformSize: 'M'
        });

        useEffect(() => {
            const savedHistory = localStorage.getItem('scout_payment_history');
            if (savedHistory) setHistory(JSON.parse(savedHistory));
        }, []);

        const generateTxId = () => {
            let currentSeq = parseInt(localStorage.getItem('scout_receipt_sequence') || '0');
            let nextSeq = currentSeq + 1;
            localStorage.setItem('scout_receipt_sequence', nextSeq.toString());
            const seqStr = nextSeq.toString().padStart(4, '0');
            return `AYA-${LEADER_ID}-${seqStr}`;
        };

        const handleInputChange = (e) => {
            const { name, value } = e.target;
            setFormData(prev => ({ ...prev, [name]: value }));
        };

        const toggleMonth = (month) => {
            setFormData(prev => {
                const currentMonths = prev.membershipMonths || [];
                const newMonths = currentMonths.includes(month)
                    ? currentMonths.filter(m => m !== month)
                    : [...currentMonths, month];
                return { ...prev, membershipMonths: newMonths };
            });
        };

        const syncToCloud = async (receiptData) => {
            if (!GOOGLE_SCRIPT_URL) return 'Offline/Local Only';
            try {
                let detailedType = receiptData.type;
                if (receiptData.type === '‘±’∂’§’°’¥’°’æ’≥’°÷Ä' && receiptData.membershipMonths?.length > 0) {
                    detailedType += ` (${receiptData.membershipMonths.join(', ')})`;
                } else if (receiptData.type === '’è’°÷Ä’°’¶') {
                    detailedType += ` - ${receiptData.uniformItem}`;
                    if (ITEMS_WITH_SIZE.includes(receiptData.uniformItem)) {
                        detailedType += ` (${receiptData.uniformSize})`;
                    }
                }

                const payload = {
                    ...receiptData,
                    detailedType: detailedType,
                    folderId: DRIVE_FOLDER_ID 
                };

                await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors', 
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                return 'Sent to Sheet & Drive';
            } catch (error) {
                console.error("Cloud Error", error);
                return 'Cloud Error (Saved Locally)';
            }
        };

        const handleSubmit = async (e) => {
            e.preventDefault();
            setLoading(true);

            const newReceipt = {
                ...formData,
                id: generateTxId(),
                timestamp: new Date().toISOString() 
            };

            const updatedHistory = [newReceipt, ...history];
            setHistory(updatedHistory);
            localStorage.setItem('scout_payment_history', JSON.stringify(updatedHistory));

            const syncStatus = await syncToCloud(newReceipt);
            setGeneratedReceipt({ ...newReceipt, status: syncStatus });
            setLoading(false);
            setActiveTab('receipt');
        };

        const handleManualSaveToDrive = async () => {
            if(!generatedReceipt) return;
            setLoading(true);
            const status = await syncToCloud(generatedReceipt);
            setGeneratedReceipt(prev => ({ ...prev, status: status }));
            setLoading(false);
            alert("’ä’°’∞’°’∂’ª’® ’∏÷Ç’≤’°÷Ä’Ø’æ’°’Æ ’ß Google Drive!");
        };

        const getDetailsString = (data) => {
            if (data.type === '‘±’∂’§’°’¥’°’æ’≥’°÷Ä') {
                return data.membershipMonths && data.membershipMonths.length > 0 
                    ? `‘±’¥’´’Ω’∂’•÷Ä: ${data.membershipMonths.join(', ')}` 
                    : '';
            }
            if (data.type === '’è’°÷Ä’°’¶') {
                let str = data.uniformItem;
                if (ITEMS_WITH_SIZE.includes(data.uniformItem)) {
                    str += ` (’â’°÷É’Ω: ${data.uniformSize})`;
                }
                return str;
            }
            return '';
        };

        const copyToClipboard = () => {
            if (!generatedReceipt) return;
            const details = getDetailsString(generatedReceipt);
            const text = `
‚õ∫ AYA SCOUTS - ’é’É‘±’ê’Ñ‘±’Ü ‘±’Ü‘¥’à’ê’ê‘±‘≥‘ª’ê
---------------------------
ID: ${generatedReceipt.id}
‘±’¥’Ω’°’©’´’æ: ${generatedReceipt.paymentDate}
’ç’Ø’°’∏÷Ç’ø: ${generatedReceipt.scoutName}
‘≥’∏÷Ç’¥’°÷Ä: ÷è${generatedReceipt.amount}
’Ü’∫’°’ø’°’Ø: ${generatedReceipt.type}
${details ? `’Ñ’°’∂÷Ä’°’¥’°’Ω’∂’•÷Ä: ${details}` : ''}
’é’≥’°÷Ä’∏’≤: ${generatedReceipt.paidBy}
’ç’ø’°÷Å’∏’≤: ${generatedReceipt.leaderName}
---------------------------
‚úÖ ’Ä‘±’ç’è‘±’è’é‘±‘æ ‘∑
`.trim();
            navigator.clipboard.writeText(text);
            alert('’è’•÷Ñ’Ω’ø’® ’∫’°’ø’≥’•’∂’æ’•÷Å');
        };

        const handlePrint = () => window.print();

        const handleNativeShare = async () => {
            if (!generatedReceipt) return;
            const details = getDetailsString(generatedReceipt);
            const text = `‚õ∫ AYA SCOUTS ‘±’Ü‘¥’à’ê’ê‘±‘≥‘ª’ê\nID: ${generatedReceipt.id}\n’ç’Ø’°’∏÷Ç’ø: ${generatedReceipt.scoutName}\n‘≥’∏÷Ç’¥’°÷Ä: ÷è${generatedReceipt.amount}\n’Ü’∫’°’ø’°’Ø: ${generatedReceipt.type} ${details}\n\n’ç’ø’°÷Å’∏’≤: ${generatedReceipt.leaderName}`;

            if (navigator.share) {
                try {
                    await navigator.share({ title: 'Scout Receipt', text: text });
                } catch (err) { console.log('Share canceled'); }
            } else {
                copyToClipboard();
            }
        };

        const resetForm = () => {
            setFormData({
                scoutName: '',
                amount: '',
                paymentDate: new Date().toISOString().split('T')[0],
                type: '‘±’∂’§’°’¥’°’æ’≥’°÷Ä',
                paidBy: '‘æ’∂’∏’≤',
                leaderName: formData.leaderName,
                notes: '',
                membershipMonths: [],
                uniformItem: '’á’°’∫’´’Ø',
                uniformSize: 'M'
            });
            setGeneratedReceipt(null);
            setActiveTab('new');
        };

        const ReceiptCard = ({ data }) => {
            const extraDetails = getDetailsString(data);
            return (
                <div className="receipt-paper">
                    <div className="watermark">PAID</div>
                    <div className="flex flex-col items-center mb-4">
                        <img 
                            src="AYA.png" 
                            alt="AYA Logo" 
                            className="h-20 object-contain mb-2"
                            onError={(e) => { e.target.style.display = 'none'; e.target.nextSibling.style.display = 'block'; }}
                        />
                        <div className="hidden"><Icons.Shield className="w-16 h-16 text-blue-900" /></div>
                        <h2 className="text-xl font-bold text-gray-900 tracking-tight mt-2 uppercase">’é’≥’°÷Ä’¥’°’∂ ‘±’∂’§’∏÷Ä÷Ä’°’£’´÷Ä</h2>
                        <p className="text-xs text-gray-500 font-mono">{data.id}</p>
                    </div>

                    <div className="space-y-4 text-base">
                        <div className="receipt-row">
                            <span className="text-gray-500">‘±’¥’Ω’°’©’´’æ</span>
                            <span className="font-semibold">{data.paymentDate}</span>
                        </div>
                        <div className="receipt-row">
                            <span className="text-gray-500">’ç’Ø’°’∏÷Ç’ø</span>
                            <span className="font-bold text-gray-800">{data.scoutName}</span>
                        </div>
                        <div className="receipt-row">
                            <span className="text-gray-500">’Ü’∫’°’ø’°’Ø</span>
                            <span className="text-gray-800 text-right">{data.type}</span>
                        </div>
                        
                        {extraDetails && (
                            <div className="bg-gray-50 p-2 rounded text-sm text-center border border-gray-100">
                                <span className="text-gray-800 font-medium">{extraDetails}</span>
                            </div>
                        )}

                        <div className="receipt-row pt-2 border-t border-dashed border-gray-300">
                            <span className="text-gray-500">‘≥’∏÷Ç’¥’°÷Ä</span>
                            <span className="text-3xl font-bold text-blue-900">÷è{data.amount}</span>
                        </div>
                    </div>

                    <div className="mt-8 pt-4 border-t border-gray-100 text-center">
                        <p className="text-[12px] text-gray-400 uppercase tracking-widest">’ç’ø’°÷Å’∏’≤ (’Ç’•’Ø’°’æ’°÷Ä)</p>
                        <p className="font-medium text-gray-700 text-base">{data.leaderName}</p>
                    </div>
                </div>
            );
        };

        return (
            <div>
                {/* Home Button */}
                <a href="index.html" style={{position: 'absolute', top: '20px', left: '20px', zIndex: 100, textDecoration: 'none', fontSize: '24px', background: 'rgba(255,255,255,0.2)', width: '40px', height: '40px', borderRadius: '50%', display: 'flex', alignItems: 'center', justifyContent: 'center', backdropFilter: 'blur(5px)', boxShadow: '0 4px 6px rgba(0,0,0,0.1)'}}>
                    üè†
                </a>

                <div className="ambient-light">
                    <div className="orb orb-1"></div>
                    <div className="orb orb-2"></div>
                </div>

                <div className="max-w-md mx-auto p-6 pt-20">
                    <div className="text-center mb-8 relative z-10">
                        <img src="AYA.png" alt="Logo" className="w-24 mx-auto mb-2 drop-shadow-xl" style={{animation:'levitate 6s ease-in-out infinite'}} />
                        <h1 className="text-2xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-slate-800 to-slate-500">‘±’∂’§’∏÷Ä÷Ä’°’£÷Ä’´ ’ç’ø’•’≤’Æ’∏÷Ç’¥</h1>
                        <p className="text-slate-400 text-sm font-medium">’ñ’´’∂’°’∂’Ω’°’Ø’°’∂ ‘≥’∏÷Ä’Æ’´÷Ñ</p>
                    </div>

                    <div className="glass-card">
                        {activeTab === 'new' && (
                            <form onSubmit={handleSubmit} className="space-y-6">
                                <div className="grid grid-cols-2 gap-4">
                                    <div>
                                        <label>‘±’¥’Ω’°’©’´’æ</label>
                                        <input type="date" name="paymentDate" required value={formData.paymentDate} onChange={handleInputChange} />
                                    </div>
                                    <div>
                                        <label>‘≥’∏÷Ç’¥’°÷Ä (÷è)</label>
                                        <input type="number" name="amount" required placeholder="5000" className="font-bold text-lg" value={formData.amount} onChange={handleInputChange} />
                                    </div>
                                </div>
                                <div>
                                    <label>’ç’Ø’°’∏÷Ç’ø’´ ‘±’∂’∏÷Ç’∂</label>
                                    <input type="text" name="scoutName" required placeholder="‘±÷Ä’°’¥ ‘±÷Ä’°’¥’µ’°’∂" value={formData.scoutName} onChange={handleInputChange} />
                                </div>
                                <div>
                                    <label>’é’≥’°÷Ä’¥’°’∂ ’Ü’∫’°’ø’°’Ø</label>
                                    <select name="type" value={formData.type} onChange={(e) => {
                                        handleInputChange(e);
                                        setFormData(prev => ({...prev, type: e.target.value, membershipMonths: [], uniformItem: '’á’°’∫’´’Ø'}));
                                    }}>
                                        <option>‘±’∂’§’°’¥’°’æ’≥’°÷Ä</option>
                                        <option>’è’°÷Ä’°’¶</option>
                                        <option>‘≤’°’∂’°’Ø’¥’°’∂ ‘ø’°’∂’≠’°’æ’≥’°÷Ä</option>
                                        <option>’Ä’°’∂’£’°’∂’°’Ø’∏÷Ç’©’µ’∏÷Ç’∂</option>
                                        <option>‘±’µ’¨</option>
                                    </select>
                                </div>

                                {formData.type === '‘±’∂’§’°’¥’°’æ’≥’°÷Ä' && (
                                    <div className="bg-indigo-50/50 p-4 rounded-2xl border border-indigo-100">
                                        <label className="!text-indigo-900 !ml-0 mb-3">‘∏’∂’ø÷Ä’•’¨ ‘±’¥’´’Ω’∂’•÷Ä</label>
                                        <div className="grid grid-cols-4 gap-2">
                                            {MONTHS.map(m => (
                                                <button key={m} type="button" onClick={() => toggleMonth(m)} className={`chip ${formData.membershipMonths.includes(m) ? 'active' : ''}`}>{m}</button>
                                            ))}
                                        </div>
                                    </div>
                                )}

                                {formData.type === '’è’°÷Ä’°’¶' && (
                                    <div className="bg-indigo-50/50 p-4 rounded-2xl border border-indigo-100 grid grid-cols-2 gap-3">
                                        <div>
                                            <label className="!text-indigo-900 !ml-0">’è’•’Ω’°’Ø</label>
                                            <select name="uniformItem" value={formData.uniformItem} onChange={handleInputChange}>
                                                {UNIFORM_ITEMS.map(item => <option key={item} value={item}>{item}</option>)}
                                            </select>
                                        </div>
                                        {ITEMS_WITH_SIZE.includes(formData.uniformItem) && (
                                            <div>
                                                <label className="!text-indigo-900 !ml-0">’â’°÷É’Ω</label>
                                                <select name="uniformSize" value={formData.uniformSize} onChange={handleInputChange}>
                                                    {SIZES.map(s => <option key={s} value={s}>{s}</option>)}
                                                </select>
                                            </div>
                                        )}
                                    </div>
                                )}

                                <div>
                                    <label>’é’≥’°÷Ä’∏’≤</label>
                                    <div className="flex gap-3">
                                        <button type="button" onClick={() => setFormData({...formData, paidBy: '‘æ’∂’∏’≤'})} className={`flex-1 p-3 rounded-xl border font-semibold text-sm transition ${formData.paidBy === '‘æ’∂’∏’≤' ? 'bg-slate-800 text-white border-slate-800' : 'bg-white text-slate-500 hover:bg-slate-50'}`}>‘æ’∂’∏’≤</button>
                                        <button type="button" onClick={() => setFormData({...formData, paidBy: '’ç’Ø’°’∏÷Ç’ø'})} className={`flex-1 p-3 rounded-xl border font-semibold text-sm transition ${formData.paidBy === '’ç’Ø’°’∏÷Ç’ø' ? 'bg-slate-800 text-white border-slate-800' : 'bg-white text-slate-500 hover:bg-slate-50'}`}>’ç’Ø’°’∏÷Ç’ø</button>
                                    </div>
                                </div>

                                <div>
                                    <label>’ç’ø’°÷Å’∏’≤ (’Ç’•’Ø’°’æ’°÷Ä)</label>
                                    <input type="text" name="leaderName" required placeholder="’Ç’•’Ø’°’æ’°÷Ä’´ ‘±’∂’∏÷Ç’∂" value={formData.leaderName} onChange={handleInputChange} />
                                </div>

                                <button type="submit" disabled={loading} className="btn-primary">
                                    {loading ? '’ç’ø’•’≤’Æ’æ’∏÷Ç’¥ ’ß...' : <><Icons.Save className="w-5 h-5" /> ’ç’ø’•’≤’Æ’•’¨ ‘±’∂’§’∏÷Ä÷Ä’°’£’´÷Ä</>}
                                </button>
                                {!GOOGLE_SCRIPT_URL && <p className="text-center text-xs text-orange-500">‚ö† Offline Mode</p>}
                            </form>
                        )}

                        {activeTab === 'receipt' && generatedReceipt && (
                            <div>
                                <ReceiptCard data={generatedReceipt} />
                                <div className="grid grid-cols-2 gap-3 mt-6">
                                    <button onClick={handlePrint} className="btn-secondary"><Icons.Printer className="w-4 h-4"/> ’è’∫’•’¨/PDF</button>
                                    <button onClick={handleNativeShare} className="btn-primary" style={{width:'auto'}}><Icons.Share2 className="w-4 h-4"/> ‘ø’´’Ω’æ’•’¨</button>
                                </div>
                                <div className="grid grid-cols-2 gap-3 mt-3">
                                    <button onClick={copyToClipboard} className="btn-secondary"><Icons.Copy className="w-4 h-4"/> ’ä’°’ø’≥’•’∂’•’¨</button>
                                    <button onClick={handleManualSaveToDrive} className="btn-secondary !text-green-600 !border-green-100"><Icons.Cloud className="w-4 h-4"/> Drive-’∏÷Ç’¥</button>
                                </div>
                                <button onClick={resetForm} className="w-full mt-6 py-3 text-sm font-semibold text-slate-400 hover:text-slate-600 transition">+ ’Ü’∏÷Ä ’é’≥’°÷Ä’∏÷Ç’¥</button>
                            </div>
                        )}

                        {activeTab === 'history' && (
                            <div>
                                <h2 className="text-xl font-bold mb-4">’ä’°’ø’¥’∏÷Ç’©’µ’∏÷Ç’∂</h2>
                                {history.length === 0 ? (
                                    <div className="text-center py-10 text-slate-400 border-2 border-dashed border-slate-200 rounded-2xl">‘¥’•’º ’°’∂’§’∏÷Ä÷Ä’°’£÷Ä’•÷Ä ’π’Ø’°’∂</div>
                                ) : (
                                    <div className="space-y-3">
                                        {history.map((item) => (
                                            <div key={item.id} onClick={() => { setGeneratedReceipt(item); setActiveTab('receipt'); }}
                                                className="bg-white p-4 rounded-xl border border-slate-100 shadow-sm flex justify-between items-center cursor-pointer hover:shadow-md transition"
                                            >
                                                <div>
                                                    <p className="font-bold text-slate-800">{item.scoutName}</p>
                                                    <p className="text-xs text-slate-500">{item.paymentDate} ‚Ä¢ {item.type}</p>
                                                </div>
                                                <div className="text-right">
                                                    <p className="font-bold text-indigo-600">÷è{item.amount}</p>
                                                    <p className="text-[10px] text-slate-400">{item.id}</p>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                )}
                            </div>
                        )}
                    </div>
                </div>

                <nav>
                    <div className={`nav-item ${activeTab === 'new' ? 'active' : ''}`} onClick={() => setActiveTab('new')}><Icons.FileText className="w-6 h-6" /></div>
                    <div className={`nav-item ${activeTab === 'history' ? 'active' : ''}`} onClick={() => setActiveTab('history')}><Icons.History className="w-6 h-6" /></div>
                </nav>
            </div>
        );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
</script>

</body>
</html>
